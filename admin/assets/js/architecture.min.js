/* This file is part of Mura CMS. 

	Mura CMS is free software: you can redistribute it and/or modify 
	it under the terms of the GNU General Public License as published by 
	the Free Software Foundation, Version 2 of the License. 

	Mura CMS is distributed in the hope that it will be useful, 
	but WITHOUT ANY WARRANTY; without even the implied warranty of 
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the 
	GNU General Public License for more details. 

	You should have received a copy of the GNU General Public License 
	along with Mura CMS.  If not, see <http://www.gnu.org/licenses/>. 

	Linking Mura CMS statically or dynamically with other modules constitutes the preparation of a derivative work based on 
	Mura CMS. Thus, the terms and conditions of the GNU General Public License version 2 ("GPL") cover the entire combined work.
	
	However, as a special exception, the copyright holders of Mura CMS grant you permission to combine Mura CMS with programs
	or libraries that are released under the GNU Lesser General Public License version 2.1.
	
	In addition, as a special exception, the copyright holders of Mura CMS grant you permission to combine Mura CMS with 
	independent software modules (plugins, themes and bundles), and to distribute these plugins, themes and bundles without 
	Mura CMS under the license of your choice, provided that you follow these specific guidelines: 
	
	Your custom code 
	
	• Must not alter any default objects in the Mura CMS database and
	• May not alter the default display of the Mura CMS logo within Mura CMS and
	• Must not alter any files in the following directories.
	
	 /admin/
	 /tasks/
	 /config/
	 /requirements/mura/
	 /Application.cfc
	 /index.cfm
	 /MuraProxy.cfc
	
	You may copy and distribute Mura CMS with a plug-in, theme or bundle that meets the above guidelines as a combined work 
	under the terms of GPL for Mura CMS, provided that you include the source code of that other code when and as the GNU GPL 
	requires distribution of source code.
	
	For clarity, if you create a modified version of Mura CMS, you are not obligated to grant this special exception for your 
	modified version; it is your choice whether to do so, or to make such modified version available under the GNU General Public License 
	verion 2 without this exception.  You may, if you choose, apply this exception to your own modified versions of Mura CMS. */function initConfigurator(e,t){return siteManager.initConfigurator(e,t)}var siteManager={formSubmitted:!1,fileLockConfirmed:!1,hasFileLock:!1,nodeLockConfirmed:!1,hasNodeLock:!1,dirtyRelatedContent:!1,copyContentID:"",copySiteID:"",reloadURL:"",tablist:"",ckContent:function(e){var t=!1;if(t){$("#unlockfilewithnew").val("false");$("#unlocknodewithpublish").val("false");document.contentForm.cancelpendingapproval.value="false";document.contentForm.approved.value=0}if(typeof isFormBuilder!="undefined"){var n=siteManager.saveFormBuilder();if(!n){alertDialog("All fields must have a 'name' before the form can be saved.");return!1}}if(typeof document.contentForm.display!="undefined")if(document.contentForm.display.value=="2"){var r=$(".datepicker.mura-datepickerdisplayStart").val(),i=$(".datepicker.mura-datepickerdisplayStop").val();if(isDate(r,"DISPLAY START DATE")==0){alertDialog("Please enter a valid date in the 'Display Start Date' field");return!1}if(i!=""&&isDate(i,"DISPLAY STOP DATE")==0){alertDialog("Please enter a valid date in the 'Display Stop Date' field");return!1}}else{$(".datepicker.mura-datepickerdisplayStart").val("");$(".datepicker.mura-datepickerdisplayStop").val("");$("#mura-displayStart").val("");$("#mura-displayStop").val("")}if(document.contentForm.title.value==""){if(document.contentForm.type.value=="Component"){alertDialog("The form field 'Menu Title' is required");return!1}if(document.contentForm.type.value=="Form"){alertDialog("The form field 'Title' is required");return!1}alertDialog("The form field 'Long Title' is required");return!1}if(document.contentForm.type.value=="Link"&&document.contentForm.body.value==""){alertDialog("The form field 'URL' is required");return!1}if(document.contentForm.approved.value==1&&e!=""&&!confirm(e))return!1;if(!t&&typeof this.hasFileLock!="undefined"&&!this.fileLockConfirmed&&this.hasFileLock&&$("input[name='newfile']").val()!=""){confirmDialog(this.unlockfileconfirm,function(){$("#unlockfilewithnew").val("true");if(siteManager.ckContent(!1)){siteManager.formSubmitted=!0;document.contentForm.submit()}},function(){$("#unlockfilewithnew").val("false");if(siteManager.ckContent(!1)){siteManager.formSubmitted=!0;document.contentForm.submit()}});this.fileLockConfirmed=!0;return!1}if(!t&&typeof this.hasNodeLock!="undefined"&&this.hasNodeLock&&!this.nodeLockConfirmed){confirmDialog(this.unlocknodeconfirm,function(){$("#unlocknodewithpublish").val("true");if(siteManager.ckContent(!1)){siteManager.formSubmitted=!0;document.contentForm.submit()}},function(){$("#unlocknodewithpublish").val("false");if(siteManager.ckContent(!1)){siteManager.formSubmitted=!0;document.contentForm.submit()}});this.nodeLockConfirmed=!0;return!1}if(!t&&document.contentForm.muraPreviouslyApproved.value==0&&document.contentForm.approved.value==1){if(typeof currentChangesetID!="undefined"&&currentChangesetID!=""){confirmDialog(publishitemfromchangeset,function(){formSubmitted=!0;document.contentForm.submit()});return!1}if(pendingApproval!="undefined"&&pendingApproval){confirmDialog(cancelPendingApproval,function(){formSubmitted=!0;document.contentForm.cancelpendingapproval.value="true";document.contentForm.submit()},function(){formSubmitted=!0;document.contentForm.cancelpendingapproval.value="false";document.contentForm.submit()});return!1}formSubmitted=!0;return!0}if(!t){formSubmitted=!0;return!0}var s=new FormData(document.contentForm);$.ajax({url:$(document.contentForm).attr("action"),type:"post",data:s})},DHTML:document.getElementById||document.all||document.layers,lastid:"",getObj:function(e){if(document.getElementById){this.obj=document.getElementById(e);this.style=document.getElementById(e).style}else if(document.all){this.obj=document.all[e];this.style=document.all[e].style}else if(document.layers){this.obj=document.layers[e];this.style=document.layers[e]}},saveFormBuilder:function(){var e=$("#mura-templatebuilder").templatebuilder("iscomplete");if(e){jQuery("#mura-templatebuilder").templatebuilder("save");return!0}return!1},openNewContentMenu:function(e,t,n,r,i){$("#newContentMenuContainer").remove();$("body").append('<div id="newContentMenuContainer" title="Loading..." style="display:none"><div id="newContentMenu"><div class="load-inline"></div></div></div>');$("#newContentMenuContainer").dialog({resizable:!1,modal:!0,width:552,title:newContentMenuTitle,position:getDialogPosition(),open:function(){$("#newContentMenuContainer").html('<div class="ui-dialog-content ui-widget-content"><div class="load-inline"></div></div>');var n="./",s="muraAction=cArch.loadnewcontentmenu&siteid="+t+"&contentid="+e+"&parentid="+r+"&topid="+r+"&ptype="+i+"&cacheid="+Math.random();$("#newContentMenuContainer .load-inline").spin(spinnerArgs2);$.get(n+"?"+s,function(e){$("#newContentMenuContainer .load-inline").spin(!1);$("#newContentMenuContainer").html(e);$("#newContentMenuContainer").dialog("option","position","center");setToolTips(".add-content-ui")})},close:function(){$(this).dialog("destroy");$("#newContentMenuContainer").remove()}});return!1},showMenu:function(e,t,n,r,i,s,o,u){var a=t.toLowerCase();if(window.innerHeight)var f=window.pageYOffset;else if(document.documentElement&&document.documentElement.scrollTop)var f=document.documentElement.scrollTop;else if(document.body)var f=document.body.scrollTop;if(window.innerWidth)var l=window.pageXOffset;else if(document.documentElement&&document.documentElement.scrollLeft)var l=document.documentElement.scrollLeft;else if(document.body)var l=document.body.scrollLeft;var c=this.findPosX(n),h=this.findPosY(n);c+=20;document.getElementById("newZoom").style.display="none";document.getElementById("newZoomLink").style.display="none";document.getElementById("newCopy").style.display="none";document.getElementById("newCopyLink").style.display="none";document.getElementById("newCopyAllLink").style.display="none";document.getElementById("newPaste").style.display="none";document.getElementById("newPasteLink").style.display="none";document.getElementById("newContentLink").style.display="none";document.getElementById("newContent").style.display="none";document.getElementById("newZoomLink").onclick=function(){siteManager.loadSiteManagerInTab(function(){return siteManager.loadSiteManager(o,r,"00000000000000000000000000000000000","","",u,1)});return!1};document.getElementById("newZoom").style.display="";document.getElementById("newZoomLink").style.display="";if(a!="none"){document.getElementById("newCopyLink").href="javascript:siteManager.copyThis('"+o+"', '"+r+"','false')";document.getElementById("newCopyAllLink").href="javascript:siteManager.copyThis('"+o+"', '"+r+"','true')";document.getElementById("newCopy").style.display="";document.getElementById("newCopyLink").style.display="";document.getElementById("newCopyAllLink").style.display=""}if(a=="author"||a=="editor"){document.getElementById("newContentLink").onclick=function(){siteManager.openNewContentMenu(r,o,i,s,u);return!1};if(this.copySiteID!=""&&this.copyContentID!=""){document.getElementById("newPasteLink").href="javascript:siteManager.pasteThis('"+r+"')";document.getElementById("newPaste").style.display="";document.getElementById("newPasteLink").style.display=""}document.getElementById("newContentLink").style.display="";document.getElementById("newContent").style.display="";document.getElementById("newCopy").style.border=""}document.getElementById(e).style.top=h+"px";document.getElementById(e).style.left=c+"px";$("#"+e).removeClass("hide");this.astid!=""&&this.lastid!=e&&this.hideMenu(this.lastid);this.navTimer=setTimeout("siteManager.hideMenu(siteManager.lastid);",2e4);this.lastid=e},findPosX:function(e){var t=0;if(e.offsetParent)while(e.offsetParent){t+=e.offsetLeft;e=e.offsetParent}else e.x&&(t+=e.x);return t},findPosY:function(e){var t=0;if(e.offsetParent)while(e.offsetParent){t+=e.offsetTop;e=e.offsetParent}else e.y&&(t+=e.y);return t},keepMenu:function(e){this.navTimer=setTimeout("hideMenu(lastid);",2e4);$("#"+e).removeClass("hide")},hideMenu:function(e){this.navTimer!=null&&clearTimeout(this.navTimer);$("#"+e).addClass("hide")},deleteDisplayObject:function(e){var t=document.getElementById("selectedObjects"+e),n=t.selectedIndex,r=t.options.length>1?t.options.length-1:0;if(n<0)return;t.options[n]=null;this.updateDisplayObjectList(e);t.options.length&&(t.options[t.options.length-1].selected=!0)},updateDisplayObjectList:function(e){var t=document.getElementById("selectedObjects"+e),n=document.getElementById("objectList"+e);n.value="";for(var r=0;r<t.options.length;r++)n.value!=""?n.value+="^"+t.options[r].value:n.value=t.options[r].value},moveDisplayObjectUp:function(e){var t=document.getElementById("selectedObjects"+e),n=t.selectedIndex;if(n<1)return;var r=document.createElement("option"),i=document.createElement("option");r.text=t.options[n].text;r.value=t.value;r.selected="selected";i.text=t.options[n-1].text;i.value=t.options[n-1].value;t[n-1]=r;t[n]=i;this.updateDisplayObjectList(e)},moveDisplayObjectDown:function(e){var t=document.getElementById("selectedObjects"+e),n=t.selectedIndex;if(n==t.length-1)return;var r=document.createElement("option"),i=document.createElement("option");r.text=t.options[n].text;r.value=t.options[n].value;r.selected="selected";i.text=t.options[n+1].text;i.value=t.options[n+1].value;t.options[n+1]=r;t.options[n]=i;this.updateDisplayObjectList(e)},setTargetParams:function(e){var t=!isNaN(e.height.value)&&e.height.value>0?",height="+e.height.value:"",n=!isNaN(e.width.value)&&e.width.value>0?",width="+e.width.value:"",r=!isNaN(e.top.value)&&e.top.value>0?",top="+e.top.value:"",i=!isNaN(e.left.value)&&e.left.value>0?",left="+e.left.value:"",s=e.toolbar.value!=""?",toolbar="+e.toolbar.value:"",o=e.location.value!=""?",location="+e.location.value:"",u=e.directories.value!=""?",directories="+e.directories.value:"",a=e.status.value!=""?",status="+e.status.value:"",f=e.menubar.value!=""?",menubar="+e.menubar.value:"",l=e.resizable.value!=""?",resizable="+e.resizable.value:"",c=e.copyhistory.value!=""?",copyhistory="+e.copyhistory.value:"",h=e.scrollbars.value!=""?",scrollbars="+e.scrollbars.value:"";document.forms.contentForm.targetParams.value=s+o+u+a+f+l+c+h+n+t+r+i},loadSiteParents:function(e,t,n,r,i){$("#mover1").hide();var s="./",o="muraAction=cArch.siteParents&compactDisplay=true&siteid="+e+"&contentid="+t+"&parentid="+n+"&keywords="+r+"&isNew="+i+"&cacheid="+Math.random(),u=$("#mover2");$.get(s+"?"+o,function(e){$("#mover2").html(e);$("#mover2").show()})},loadAssocImages:function(e,t,n,r,i){var s="./",o="muraAction=cArch.assocImages&compactDisplay=true&siteid="+e+"&fileid="+t+"&contentid="+n+"&keywords="+r+"&isNew="+i+"&cacheid="+Math.random(),u=$("#selectAssocImage");$.get(s+"?"+o,function(e){$("#selectAssocImage").html(e);$("#selectAssocImageResults").slideDown()})},loadObjectClass:function(e,t,n,r,i,s){var o="./",u="muraAction=cArch.loadclass&compactDisplay=true&siteid="+e+"&classid="+t+"&subclassid="+n+"&contentid="+r+"&parentid="+i+"&cacheid="+Math.random(),a=$("#classList");a.html('<div class="load-inline"></div>');$("#classList .load-inline").spin(spinnerArgs2);$.get(o+"?"+u,function(e){$("#classList .load-inline").spin(!1);$("#classList").html(e);siteManager.availableObjectTemplate="";siteManager.availalbeObjectParams={};siteManager.availableObject={};siteManager.availableObjectValidate=function(){return!0}});return!1},getDisplayObjectClass:function(e){var t=$("#selectedObjects"+e).val().toString(),n=t.split("~");return n[0]},getDisplayObjectID:function(e){var t=$("#selectedObjects"+e).val().toString(),n=t.split("~");return n[2]},loadNotify:function(e,t,n){var r="./",i="muraAction=cArch.loadNotify&compactDisplay=true&siteid="+e+"&contentid="+t+"&parentid="+n+"&cacheid="+Math.random(),s=$("#selectNotify");if(s.html()==""){s.show();s.html('<div class="load-inline"></div>');$("#selectNotify .load-inline").spin(spinnerArgs2);$.get(r+"?"+i,function(e){$("#selectNotify .load-inline").spin(!1);$("#selectNotify").html(e)})}else s.toggle();return!1},loadExpiresNotify:function(e,t,n){var r="./",i="muraAction=cArch.loadExpireNotify&compactDisplay=true&siteid="+e+"&contenthistid="+t+"&parentid="+n+"&cacheid="+Math.random(),s=$("#selectExpiresNotify");if(s.html()==""){s.show();s.html('<div class="load-inline"></div>');$("#selectExpiresNotify .load-inline").spin(spinnerArgs2);$.get(r+"?"+i,function(e){$("#selectExpiresNotify .load-inline").spin(!1);$("#selectExpiresNotify").html(e)})}else s.toggle();return!1},bindDelete:function(){$("a.delete").click(function(){var e=$(this).parent().attr("data-contentid");$(this).parent().remove();siteManager.setupRCResultIcon($('#selectRelatedContent button[value="'+e+'"]'));siteManager.updateBuckets();siteManager.updateRCForm();$("#mura-rc-quickedit").hide()})},bindMouse:function(){$(".rcSortable li.item:not(.empty), .rcDraggable li.item").mouseup(function(e){if(e.which==1){siteManager.enableBuckets();$(window).unbind("mousemove")}}).mousedown(function(e){var t=!0;if(e.which==1){siteManager.disableBuckets($(this));typeof frontEndProxy!="undefined"&&$(window).bind("mousemove",function(e){if(t){frontEndProxy.post({cmd:"autoScroll",y:e.pageY});t=!1}})}timer=window.setInterval(function(){t=!0},100)})},updateBuckets:function(){$(".rcSortable").each(function(e){$(this).find("li.item").length==1?$(this).find("li.empty").removeClass("noShow"):$(this).find("li.empty").addClass("noShow")})},enableBuckets:function(){$(".rcSortable").each(function(e){$(this).sortable("enable");$(this).parent().removeClass("disabled")})},disableBuckets:function(e){$(".rcSortable").each(function(t){if($(this).attr("id")!=e.parent().attr("id")){if($(this).attr("data-accept").length>0&&$(this).attr("data-accept").indexOf(e.attr("data-content-type"))==-1){$(this).sortable("disable");$(this).parent().addClass("disabled")}if($(this).find('[data-contentid="'+e.attr("data-contentid")+'"]').length>0){$(this).sortable("disable");$(this).parent().addClass("disabled")}}})},loadRelatedContent:function(e,t,n,r,i){var s="./",o="muraAction=cArch.loadRelatedContent&compactDisplay=true&contentid="+e+"&siteid="+t+"&isNew="+n+"&"+r+"&cacheid="+Math.random(),u=$("#selectRelatedContent");u.html('<div class="load-inline"></div>');$("#selectRelatedContent .load-inline").spin(spinnerArgs2);$.get(s+"?"+o,function(r){r.indexOf("mura-primary-login-token")!=-1&&(location.href="./");$("#selectRelatedContent .load-inline").spin(!1);$("#selectRelatedContent").html(r);$("#draggableContainmentInternal").on("scroll",function(){$("#mura-rc-quickedit").hide()});$(".rcDraggable li.item").draggable({connectToSortable:".rcSortable",helper:"clone",revert:"invalid",appendTo:"body",start:function(e,t){$("#mura-rc-quickedit").hide();siteManager.bindMouse()},zIndex:100}).disableSelection();setDatePickers(".mura-relatedContent-datepicker",dtLocale,dtCh);$("#aAdvancedSearch").click(function(e){e.preventDefault();$("#rcAdvancedSearch").slideToggle("fast")});if(n==0&&i==1){$("#rcAdvancedSearch").show();$("#aAdvancedSearch").addClass("active")}siteManager.bindMouse();setCheckboxTrees();siteManager.setupRCQuikEdit();$("#rcAdvancedSearch").find("ul.categories:not(.checkboxTrees)").css("margin-left","10px");$(".mura-rc-quickoption").each(function(){siteManager.setupRCResultIcon($(this))});$("#rcBtnSearch").click(function(n){n.preventDefault();var r=$("#rcAdvancedSearch").is(":visible"),i="#internalContent input";r&&(i="#selectRelatedContent input, #selectRelatedContent select");$("#mura-rc-quickedit").hide();siteManager.loadRelatedContent(e,t,0,$(i).serialize(),r)})})},loadRelatedContentSets:function(e,t,n,r,i){var s="./",o="muraAction=cArch.loadSelectedRelatedContent&compactDisplay=true&contenthistid="+t+"&type="+n+"&subtype="+r+"&siteid="+i+"&cacheid="+Math.random(),u=$("#selectedRelatedContent");u.html('<div class="load-inline"></div>');$("#selectedRelatedContent .load-inline").spin(spinnerArgs2);$.get(s+"?"+o,function(t){t.indexOf("mura-primary-login-token")!=-1&&(location.href="./");$("#selectedRelatedContent .load-inline").spin(!1);u.html(t);siteManager.setupRCSortable(e)})},setupRCResultIcon:function(e){$("#selectedRelatedContent").find('li[data-contentid="'+e.val()+'"]').length?e.find("i").attr("class","icon-ok-sign"):e.find("i").attr("class","icon-plus-sign")},setupRCQuikEdit:function(){$(".mura-rc-quickoption").each(function(){$(this).unbind("on").on("click",function(){var e=$(this).val(),t=$("#selectRelatedContent").find('li[data-contentid="'+e+'"]');$("#mura-rc-quickedit").show();$("#mura-rc-quickedit").offset({top:$(this).offset().top});$(".mura-rc-quickassign").each(function(){var n=this,r=$("#rcSortable-"+$(n).val()),i=function(){return r.find('li[data-contentid="'+e+'"]').length};$("#mura-rc-quickedit").show();$(n).attr("disabled",!1);r.attr("id")!=t.parent().attr("id")&&r.attr("data-accept").length>0&&r.attr("data-accept").indexOf(t.attr("data-content-type"))==-1&&$(n).attr("disabled",!0);$(this).unbind("change");$(this).prop("checked",i());$(this).on("change",function(){if($(this).prop("checked")){t.clone().appendTo($("#rcSortable-"+$(n).val()));$("#rcSortable-"+$(n).val()).find(".mura-rc-quickoption").remove();$("#rcSortable-"+$(n).val()).find('li[data-contentid="'+e+'"]').append('<a class="delete"></a>')}else $("#rcSortable-"+$(n).val()).find('li[data-contentid="'+e+'"]').remove();siteManager.setupRCResultIcon($('#selectRelatedContent button[value="'+e+'"]'));siteManager.updateBuckets();siteManager.bindDelete();siteManager.bindMouse();siteManager.updateRCForm()})})})})},setupRCSortable:function(e){$(".rcSortable").sortable({connectWith:".rcSortable",revert:!0,update:function(e,t){siteManager.updateBuckets();t.item.find("a.delete").length==0&&t.item.append('<a class="delete"></a>');siteManager.bindDelete();siteManager.bindMouse();siteManager.setDirtyRelatedContent();siteManager.updateRCForm();siteManager.setupRCResultIcon($('#selectRelatedContent button[value="'+t.item.attr("data-contentid")+'"]'))},cancel:"li.empty"}).disableSelection();siteManager.loadRelatedContent(e,siteid,1,"",!1);siteManager.bindDelete();siteManager.bindMouse();siteManager.updateRCForm();siteManager.setupRCQuikEdit()},updateRCForm:function(){var e=new Array;$(".rcSortable").each(function(){var t=new Array,n=new Object;$(this).find(".mura-rc-quickoption").remove();$(this).find("li.item:not(.empty)").each(function(){typeof $(this).attr("data-url")=="undefined"?t.push($(this).attr("data-contentid")):t.push({title:$(this).attr("data-title"),url:$(this).attr("data-url"),contentid:$(this).attr("data-contentid")})});n.relatedcontentsetid=$(this).attr("data-relatedcontentsetid");n.items=t;e.push(n)});$("#relatedContentSetData").val(JSON.stringify(e))},setDirtyRelatedContent:function(){this.dirtyRelatedContent=!0},form_is_modified:function(e){for(var t=0;t<e.elements.length;t++){var n=e.elements[t],r=n.type;if(r=="checkbox"||r=="radio"){if(n.checked!=n.defaultChecked)return!0}else if(r=="hidden"||r=="password"||r=="text"||r=="textarea")if(n.value!=n.defaultValue&&n.name!="sdContent")return!0}if(typeof FCKeditorAPI!="undefined"){if(FCKeditorAPI.GetInstance("body")&&FCKeditorAPI.GetInstance("body").IsDirty())return!0;if(FCKeditorAPI.GetInstance("summary")&&FCKeditorAPI.GetInstance("summary").IsDirty())return!0;if(this.dirtyRelatedContent)return!0}else if(typeof CKEDITOR!="undefined"&&typeof CKEDITOR.instances["body"]!="undefined"){var i=CKEDITOR.instances.body;if(i.checkDirty())return!0}return!1},copyThis:function(e,t,n){var r="./",i="muraAction=cArch.saveCopyInfo&siteid="+e+"&contentid="+t+"&copyAll="+n+"&cacheid="+Math.random();$.get(r+"?"+i);this.copyContentID=t;this.copySiteID=e;this.copyAll=n;this.hideMenu("newContentMenu")},pasteThis:function(e){var t="./",n="muraAction=cArch.copy&compactDisplay=true&siteid="+this.copySiteID+"&copyAll="+this.copyAll+"&contentid="+this.copyContentID+"&parentid="+e+"&cacheid="+Math.random(),r=$("#newPasteLink");r.css("background","url(assets/images/ajax-loader.gif) no-repeat 1px 5px;");this.reloadURL=$("#newZoomLink").attr("href");actionModal(function(){$.get(t+"?"+n,function(t){$("#action-modal").remove();siteManager.loadSiteManagerInTab(function(){siteManager.loadSiteManager(siteManager.copySiteID,e,"00000000000000000000000000000000000","","","",1)})})})},reloadPage:function(){reloadURL==""?window.location.reload():location.href=this.reloadURL},loadExtendedAttributes:function(e,t,n,r,i,s,o){var u="./",a="muraAction=cArch.loadExtendedAttributes&contentHistID="+t+"&type="+n+"&subType="+r+"&siteID="+i+"&tablist="+siteManager.tablist+"&cacheid="+Math.random();siteID=i;context=s;themeAssetPath=o;$(".extendset-container").each(function(){if($(this).html()!=""){$(this).html('<div class="load-inline"></div>');$(this).find(".load-inline").spin(spinnerArgs2)}});siteManager.loadRelatedContentSets(e,t,n,r,i);$.ajax({url:u+"?"+a,dataType:"text",success:function(e){siteManager.setExtendedAttributes(e)}});return!1},setExtendedAttributes:function(data){var r=eval("("+data+")");$.each(r,function(e,t){$("#extendset-container-"+e+" .load-inline").spin(!1);$("#extendset-container-"+e).html(t)});r["default"]==""?$("#tabExtendedAttributesLI").addClass("hide"):$("#tabExtendedAttributesLI").removeClass("hide");r.hasconfigurator?$("#tabListDisplayOptionsLI").removeClass("hide"):$("#tabListDisplayOptionsLI").addClass("hide");r.hassummary?typeof showSummaryEditor!="undefined"&&showSummaryEditor():typeof hideSummaryEditor!="undefined"&&hideSummaryEditor();r.hasbody?typeof showBodyEditor!="undefined"&&showBodyEditor():typeof hideBodyEditor!="undefined"&&hideBodyEditor();if(!r.hasassocfile){$("#assocFileContainer").hide();$("input[name='newfile']").val("")}else $("#assocFileContainer").show();this.checkExtendSetTargeting();setHTMLEditors(context,themeAssetPath);setDatePickers(".tab-content .datepicker",dtLocale);setColorPickers(".tab-content .colorpicker");setFinders(".tab-content .mura-ckfinder");setToolTips(".tab-content");setFileSelectors()},checkExtendSetTargeting:function(){var e=$(".extendset"),t=!1,n=!1,r=!0;if(e.length){for(var i=0;i<e.length;i++){var s=e[i];if(s.getAttribute("categoryid")!=undefined&&s.getAttribute("categoryid")!=""){if(!n){var o=$("categoryContainer").getElementsByTagName("select");n=!0}for(var u=0;u<o.length;u++){var a=o[u],f=o[u].getAttribute("categoryid"),l=s.getAttribute("categoryid");if(!t&&f!=null&&l.indexOf(f)>-1){t=!0;membership=a.value}}if(t)if(membership!=""){this.setFormElementsDisplay(s,"");s.style.display="";r=!1}else{this.setFormElementsDisplay(s,"none");s.style.display="none"}else{this.setFormElementsDisplay(s,"none");s.style.display="none"}}else{this.setFormElementsDisplay(s,"");s.style.display="";r=!1}t=!1}if(r){$("#extendMessage").show();$("#extendDL").hide()}else{$("#extendMessage").hide();$("#extendDL").show()}}},resetExtendedAttributes:function(e,t,n,r,i,s){var o=n.split("^");this.loadExtendedAttributes(e,t,o[0],o[1],r,i,s);document.contentForm.type.value=o[0];document.contentForm.subtype.value=o[1]},setFormElementsDisplay:function(e,t){var n=e.getElementsByTagName("input");if(n.length)for(var r=0;r<n.length;r++)n[r].style.display=t;n=e.getElementsByTagName("textarea");if(n.length)for(var r=0;r<n.length;r++)n[r].style.display=t;n=e.getElementsByTagName("select");if(n.length)for(var r=0;r<n.length;r++)n[r].style.display=t},loadCategoryFeatureStartStop:function(e,t,n){var r=$("#"+e);if(r.html().length>10)r.toggle();else if(t==1){var i="./",s=e,o="muraAction=cArch.loadCategoryFeatureStartStop&id="+s.replace(/editDates/,"")+"&siteID="+n+"&cacheid="+Math.random();r.show();$.get(i+"?"+o,function(t){$("#"+e).html(t);setDatePickers("#"+e+" .datepicker",dtLocale);setToolTips("#"+e)})}},activeQuickEdit:!1,loadSiteManager:function(siteid,topid,moduleid,sortby,sortdirection,ptype,startrow){var url="./",pars="muraAction=cArch.loadSiteManager&siteid="+siteid+"&topid="+topid+"&moduleid="+moduleid+"&sortby="+sortby+"&sortdirection="+sortdirection+"&ptype="+ptype+"&startrow="+startrow+"&cacheid="+Math.random();$("#newContentMenu").addClass("hide");var d=$("#gridContainer");if(!this.activeQuickEdit){d.html('<div class="load-inline"></div>').show();$("#gridContainer .load-inline").spin(spinnerArgs2)}$.ajax({url:url+"?"+pars,dataType:"text",success:function(data){try{var r=eval("("+data+")");if(!siteManager.activeQuickEdit){d.hide();$("#gridContainer .load-inline").spin(!1)}d.html(r.html);$("#newContentMenu").addClass("hide");stripe("stripe");siteManager.initQuickEdits();initDraftPrompt();setToolTips("#gridContainer");if(r.perm.toLowerCase()=="editor"&&r.sortby.toLowerCase()=="orderno"){$("#sortableKids").sortable({stop:function(e,t){stripe("stripe");siteManager.setAsSorted();$(t.item).removeClass("ui-draggable-dragging")},start:function(e,t){$(t.item).addClass("ui-draggable-dragging")}});$("#sortableKids").disableSelection()}}catch(err){data.indexOf("mura-primary-login-token")!=-1&&(location.href="./");d.html(data)}siteManager.activeQuickEdit||d.hide().animate({opacity:"show"},1e3);siteManager.activeQuickEdit=!1},error:function(e,t,n){console.log("error "+t)}});return!1},sectionLoading:!1,loadSiteFlatByFilter:function(){var e=$("#contentTypeFilter").val();if(e!=""){var t=e.split("^");flatViewArgs.type=t[0];flatViewArgs.subtype=t[1]}else{flatViewArgs.type="";flatViewArgs.subtype=""}var n=[];$(".categories :checked").each(function(){n.push($(this).val())});flatViewArgs.categoryid=n.toString();var r=[];$("input[name='tags']").each(function(){r.push($(this).val())});flatViewArgs.tags=r.toString();if(customtaggroups.length)for(var i=0;i<customtaggroups.length;i++){r=[];$("input[name='"+customtaggroups[i]+"tags']").each(function(){$(this).val().length&&r.push($(this).val())});flatViewArgs[customtaggroups[i]+"tags"]=r.toString()}flatViewArgs.keywords=$("#contentKeywords").val();flatViewArgs.page=1;flatViewArgs.filtered=!0;this.loadSiteFlat(flatViewArgs)},loadSiteManagerInTab:function(e){archViewLoaded=!0;window.scrollTo(0,0);$("#gridContainer").html('<div class="load-inline"></div>');$('#viewTabs a[href="#tabArchitectural"]').tab("show");e();return!1},loadSiteFlat:function(args){var url="./",pars="muraAction=cArch.loadSiteFlat&cacheid="+Math.random(),d=$("#flatViewContainer");d.html('<div class="load-inline"></div>');$("#flatViewContainer .load-inline").spin(spinnerArgs2);$("#newContentMenu").addClass("hide");$.post(url+"?"+pars,args,function(data){data.indexOf("mura-primary-login-token")!=-1&&(location.href="./");$("#flatViewContainer .load-inline").spin(!1);d.html(data);stripe("stripe");setCheckboxTrees();setToolTips(".mura-table-grid");$.ajax({url:"?muraAction=carch.loadtagarray&siteid="+siteid,dataType:"text",success:function(data){var tagArray=eval("("+data+")");$("#tags").tagSelector(tagArray,"tags")}});if(customtaggroups.length)for(var g=0;g<customtaggroups.length;g++)window[customtaggroups[g]]?$("#"+customtaggroups[g]+"tags").tagSelector(window[customtaggroups[g]],customtaggroups[g]+"tags"):$.ajax({url:"?muraAction=carch.loadtagarray&siteid="+siteid+"&taggroup="+customtaggroups[g],context:{taggroup:customtaggroups[g]},dataType:"test",success:function(data){window[this.taggroup]=eval("("+data+")");$("#"+this.taggroup+"tags").tagSelector(window[this.taggroup],this.taggroup+"tags")}});$(".navSort a").click(function(e){e.preventDefault();$(".sortNav .active").toggleClass("active");$(this).toggleClass("active");var t=$(this).attr("data-sortby");if(t==flatViewArgs.sortby)flatViewArgs.sortdirection=="asc"?flatViewArgs.sortdirection="desc":flatViewArgs.sortdirection="asc";else{flatViewArgs.sortby=t;switch(flatViewArgs.sortby){case"menutitle":flatViewArgs.sortdirection="asc";break;case"created":case"lastupdate":case"releasedate":flatViewArgs.sortdirection="desc"}}flatViewArgs.page=1;siteManager.loadSiteFlat(flatViewArgs)});$("#navReports a").click(function(e){e.preventDefault();$(".navReports .active").toggleClass("active");$(this).toggleClass("active");var t=$(this).attr("data-report");(flatViewArgs.report=="mylockedfiles"||flatViewArgs.report=="lockedfiles")&&t!="mylockedfiles"&&t!="lockedfiles"&&(flatViewArgs.type="");flatViewArgs.report=t;if(flatViewArgs.report=="mylockedfiles"||flatViewArgs.report=="lockedfiles")flatViewArgs.type="File";flatViewArgs.page=1;siteManager.loadSiteFlat(flatViewArgs)});$("#tabFlat .moreResults a").click(function(e){e.preventDefault();$("#tabFlat .moreResults a").toggleClass("active");$(this).toggleClass("active");flatViewArgs.page=$(this).attr("data-page");siteManager.loadSiteFlat(flatViewArgs)});initDraftPrompt();d.hide().animate({opacity:"show"},1e3)});return!1},loadSiteSection:function(node,startrow){var clearTimer=function(){$("#mura-section-loading").spin(!1);$("#mura-section-loading").remove();$("#mura-grid-loader").remove();clearTimeout(startTimer)};clearTimer();if(!this.sectionLoading){this.sectionLoading=!0;var url="./",pars="muraAction=cArch.loadSiteSection&siteid="+node.attr("data-siteid")+"&contentID="+node.attr("data-contentid")+"&moduleid="+node.attr("data-moduleid")+"&sortby="+node.attr("data-sortby")+"&sortdirection="+node.attr("data-sortdirection")+"&ptype="+node.attr("data-type")+"&startrow="+startrow+"&cacheid="+Math.random(),icon=node.find("span:first");if(icon.hasClass("hasChildren closed")){var startTimer=setTimeout(function(){$("body").prepend('<div id="mura-section-loading" class="spinner-wrap"></div>');$(".mura-grid").prepend('<div id="mura-grid-loader"></div>');$("#mura-section-loading").spin(spinnerArgs3)},1e3);icon.removeClass("hasChildren closed");icon.addClass("hasChildren open");$.ajax({url:url+"?"+pars,dataType:"text",success:function(data){try{var r=eval("("+data+")");node.find(".mura-section:first").remove();node.append(r.html);$("#newContentMenu").addClass("hide");stripe("stripe");initDraftPrompt();siteManager.initQuickEdits();document.all&&document.querySelector&&!document.addEventListener||node.find(".mura-section:first").hide().fadeIn("slow")}catch(err){data.indexOf("mura-primary-login-token")!=-1&&(location.href="./");node.append(data)}clearTimer();siteManager.sectionLoading=!1}})}else{icon.removeClass("hasChildren open");icon.addClass("hasChildren closed");$.get(url+"?"+pars);node.find(".mura-section:first").fadeOut("fast",function(){node.find(".mura-section:first").remove();stripe("stripe");$("#newContentMenu").addClass("hide");siteManager.sectionLoading=!1})}}return!1},refreshSiteSection:function(node,startrow
){if(!this.sectionLoading){this.sectionLoading=!0;var url="./",pars="muraAction=cArch.refreshSiteSection&siteid="+node.attr("data-siteid")+"&contentID="+node.attr("data-contentid")+"&moduleid="+node.attr("data-moduleid")+"&sortby="+node.attr("data-sortby")+"&sortdirection="+node.attr("data-sortdirection")+"&ptype="+node.attr("data-type")+"&startrow="+startrow+"&cacheid="+Math.random();$.ajax({url:url+"?"+pars,dataType:"text",success:function(data){try{var r=eval("("+data+")");node.find(".mura-section:first").remove();node.append(r.html);$("#newContentMenu").addClass("hide");stripe("stripe");initDraftPrompt();siteManager.initQuickEdits()}catch(err){data.indexOf("mura-primary-login-token")!=-1&&(location.href="./");node.append(data)}siteManager.activeQuickEdit=!1;siteManager.sectionLoading=!1}})}return!1},setAsSorted:function(){$("#sorted").val("true");$("#sitemgr-reorder").fadeIn()},initQuickEdits:function(){$(".mura-quickEditItem").click(function(e){e.preventDefault();$(this).data("clicked",!$(this).data("clicked"));if($(this).data("clicked")){if(!this.activeQuickEdit){var t=$(this).attr("data-attribute"),n=$(this).parents("li:first"),r="./",i="muraAction=cArch.loadQuickEdit&siteid="+siteid+"&contentID="+n.attr("data-contentid")+"&attribute="+t+"&cacheid="+Math.random();$("#mura-quickEditor").remove();$("#selected").attr("id","");$("#selectedIcon").attr("id","").attr("src","assets/images/icons/template_24x24.png");$(this).parent().prepend(quickEditTmpl);var s=$("#mura-quickEditor"),o=s.parents("dd:first");o.attr("id","selected");$.get(r+"?"+i,function(e){e.indexOf("mura-primary-login-token")!=-1&&(location.href="./");$("#mura-quickEditor").html(e);$("#mura-quickEditor").find("input, select").bind("mousedown.ui-disableSelection selectstart.ui-disableSelection",function(e){e.stopImmediatePropagation()});setDatePickers(".mura-quickEdit-datepicker",dtLocale,dtCh);setToolTips(".mura-quickEdit-datepicker");$("#hasDraftsMessage").length&&o.addClass("hasDraft");if(t=="template"){var n=o.find("img:first");n.length&&n.attr("id","selectedIcon").attr("src","assets/images/icons/template_24x24-on.png")}})}}else siteManager.closeQuickEdit()})},saveQuickEdit:function(){this.activeQuickEdit=!0;var e=$("#mura-quickEditor").parent().find(".mura-quickEditItem:first").attr("data-attribute"),t=$("#mura-quickEditor").parents("li:first"),n="./",r={muraAction:"cArch.saveQuickEdit",siteID:siteID,contentID:t.attr("data-contentid"),attribute:e};if(e=="isnav")var i={isnav:$("#mura-quickEdit-isnav").val()};else if(e=="inheritObjects")var i={inheritObjects:$("#mura-quickEdit-inheritobjects").val()};else if(e=="template")var i={template:$("#mura-quickEdit-template").val(),childTemplate:$("#mura-quickEdit-childtemplate").val()};else if(e=="display")var i={display:$("#mura-quickEdit-display").val(),displayStop:$("#mura-quickEdit-displayStop").val(),displayStart:$("#mura-quickEdit-displayStart").val()};var s=$.extend({},r,i);$("#mura-quickEditor").html('<img class="loader" src="assets/images/ajax-loader-alt.gif" />');$.ajax({type:"POST",url:"./index.cfm?"+t.attr("data-csrf"),data:s,success:function(e){e.indexOf("mura-primary-login-token")!=-1&&(location.href="./");var n=t.parents("li:first");if(n.parents("li:first").length)siteManager.refreshSiteSection(n,1);else{var r=$("#top-node").parents("li:first");siteManager.loadSiteManager(r.attr("data-siteid"),r.attr("data-contentid"),r.attr("data-moduleid"),r.attr("data-sortby"),r.attr("data-sortdirection"),r.attr("data-type"),1)}},error:function(e,t,n){alert(e.responseText)},dataType:"text"})},closeQuickEdit:function(){$("#selected").attr("id","");$("#selectedIcon").attr("id","").attr("src","assets/images/icons/template_24x24.png");$(".mura-quickEdit").remove()},initCategoryAssignments:function(){$(".mura-quickEditItem").click(function(e){e.preventDefault();$(this).data("clicked",!$(this).data("clicked"));if($(this).data("clicked")){var t=$(this).parents("li:first"),n=t.attr("data-cattrim"),r={muraAction:"cArch.loadCategoryAssignment",cattrim:t.attr("data-cattrim"),siteID:t.attr("data-siteid"),categoryID:t.attr("data-categoryid"),categoryAssignment:$("#categoryAssign"+n).val(),featureStart:"",startHour:"",startMinute:"",startDayPart:"",featureStop:"",stopHour:"",stopMinute:"",stopDayPart:""};r.categoryAssignment=="2"&&$.extend(r,{featureStart:$("#featureStart"+n).val(),startHour:$("#startHour"+n).val(),startMinute:$("#startMinute"+n).val(),startDayPart:$("#startDayPart"+n).val(),featureStop:$("#featureStop"+n).val(),stopHour:$("#stopHour"+n).val(),stopMinute:$("#stopMinute"+n).val(),stopDayPart:$("#stopDayPart"+n).val()});$("#mura-quickEditor").remove();$("#selected").attr("id","");$("#selectedIcon").attr("id","").attr("src","assets/images/icons/template_24x24.png");$(this).parent().prepend(quickEditTmpl);var i=$("#mura-quickEditor"),s=i.parents("dd:first");s.attr("id","selected");$.ajax({type:"POST",url:"./index.cfm",data:r,success:function(e){e.indexOf("mura-primary-login-token")!=-1&&(location.href="./");$("#mura-quickEditor").html(e);setDatePickers(".mura-quickEdit-datepicker",dtLocale,dtCh);setToolTips(".mura-quickEdit-datepicker")},error:function(e,t,n){alert(n)},dataType:"text"})}else siteManager.closeQuickEdit()})},saveCategoryAssignment:function(){var e=$("#mura-quickEdit-cattrim").val(),t={muraAction:"cArch.loadCategoryFeatureStartStop",cattrim:e,categoryAssignment:$("#mura-quickEdit-display").val(),featureStart:$("#mura-quickEdit-featureStart").val(),startHour:$("#mura-quickEdit-startHour").val(),startMinute:$("#mura-quickEdit-startMinute").val(),startDayPart:$("#mura-quickEdit-startDayPart").length?$("#mura-quickEdit-startDayPart").val():"",featureStop:$("#mura-quickEdit-featureStop").val(),stopHour:$("#mura-quickEdit-stopHour").val(),stopMinute:$("#mura-quickEdit-stopMinute").val(),stopDayPart:$("#mura-quickEdit-stopDayPart").length?$("#mura-quickEdit-stopDayPart").val():"",siteid:siteid};$("#mura-quickEditor").html('<img class="loader" src="assets/images/ajax-loader-alt.gif" />');$.ajax({type:"POST",url:"./index.cfm",data:t,success:function(t){t.indexOf("mura-primary-login-token")!=-1&&(location.href="./");$("#categoryLabelContainer"+e).html(t);siteManager.closeCategoryAssignment();setToolTips(".mura-quickEdit-datepicker");siteManager.initCategoryAssignments()},error:function(e,t,n){alert(n)},dataType:"text"})},closeCategoryAssignment:function(){$("#selected").attr("id","");$(".mura-quickEdit").remove()},availableObjectTemplate:"",availalbeObjectParams:{},availableObject:{},availableObjectValidate:function(){return!0},getDisplayObjectConfig:function(e){var t=$("#selectedObjects"+e),n=t.val().toString(),r=n.split("~"),i={};i.object=r[0];i.name=r[1];i.objectid=r[2];r.length>3&&(i.params=r[3]);i.regionid=e;i.context=context;i.siteid=siteid;i.contentid=contentid;i.contenthistid=contenthistid;i.parentid=parentid;return i},addDisplayObject:function(objectToAdd,regionid,configure){var tmpObject="",tmpValue="",tmpText="",isUpdate=!1;if(typeof objectToAdd=="string"){if(document.getElementById(objectToAdd)==null){alertDialog("Please select a display object.");return!1}if(document.getElementById(objectToAdd).tagName.toLowerCase()=="select"){if(document.getElementById(objectToAdd).selectedIndex==-1){alertDialog("Please select a display object.");return!1}var addIndex=document.getElementById(objectToAdd).selectedIndex;if(addIndex<0)return!1;var addoption=document.getElementById(objectToAdd).options[addIndex];tmpText=addoption.text;tmpValue=addoption.value}else if(document.getElementById(objectToAdd).tagName.toLowerCase()=="input"){var addoption=document.getElementById(objectToAdd);tmpValue=addoption.value}else addoption=document.getElementById(objectToAdd);try{tmpObject=eval("("+addoption.value+")")}catch(err){tmpObject=addoption.value}}else tmpObject=objectToAdd;var checkSelection=!1;if(typeof tmpObject=="object"){tmpObject.regionid=regionid;tmpObject.context=context;tmpObject.siteid=siteid;tmpObject.contentid=contentid;tmpObject.contenthistid=contenthistid;tmpObject.parentid=parentid;if(tmpObject.object=="feed"){if(configure){tmpObject.regionid=regionid;if(this.initFeedConfigurator(tmpObject))return!1}checkSelection=!0}if(tmpObject.object=="feed_slideshow"){if(configure){tmpObject.regionid=regionid;this.initSlideShowConfigurator(tmpObject);return!1}checkSelection=!0}if(tmpObject.object=="tag_cloud"&&customtaggroups.length){if(configure){tmpObject.regionid=regionid;this.initTagCloudConfigurator(tmpObject);return!1}checkSelection=!0}if(allowopenfeeds&&tmpObject.object=="category_summary"){if(configure){tmpObject.regionid=regionid;this.initCategorySummaryConfigurator(tmpObject);return!1}checkSelection=!0}if(tmpObject.object=="related_content"||tmpObject.object=="related_section_content"){if(configure){tmpObject.regionid=regionid;this.initRelatedContentConfigurator(tmpObject);return!1}checkSelection=!0}if(tmpObject.object=="site_map"){if(configure){tmpObject.regionid=regionid;this.initSiteMapConfigurator(tmpObject);return!1}checkSelection=!0}if(tmpObject.object=="plugin"){var configurator=this.getPluginConfigurator(tmpObject.objectid);if(configurator!=""){if(configure){window[configurator](tmpObject);return!1}checkSelection=!0}}tmpValue=tmpObject.object;tmpValue=tmpValue+"~"+tmpObject.name;tmpValue=tmpValue+"~"+tmpObject.objectid;typeof tmpObject.params=="string"?tmpValue=tmpValue+"~"+tmpObject.params:typeof tmpObject.params=="object"&&(tmpValue=tmpValue+"~"+JSON.stringify(tmpObject.params));if(checkSelection&&document.getElementById("selectedObjects"+regionid).selectedIndex!=-1){var currentSelection=this.getDisplayObjectConfig(regionid);currentSelection&&currentSelection.objectid==tmpObject.objectid&&(isUpdate=!0)}tmpText=tmpObject.name}if(tmpValue==""){alertDialog("Please select a display object.");return!1}var selectedObjects=document.getElementById("selectedObjects"+regionid);if(selectedObjects.options.length)for(var i=0;i<selectedObjects.options.length;i++)if(selectedObjects.options[i].value==tmpValue){selectedObjects.selectedIndex=i;return!1}if(isUpdate){myoption=selectedObjects.options[document.getElementById("selectedObjects"+regionid).selectedIndex];myoption.text=tmpText;myoption.value=tmpValue}else{var myoption=document.createElement("option");selectedObjects.appendChild(myoption);myoption.text=tmpText;myoption.value=tmpValue;myoption.selected="selected"}this.updateDisplayObjectList(regionid);return!0},initTagCloudConfigurator:function(e){this.initConfigurator(e,{url:"./",pars:"muraAction=cArch.loadclassconfigurator&compactDisplay=true&siteid="+siteid+"&classid=tag_cloud&contentid="+contentid+"&parentid="+parentid+"&contenthistid="+contenthistid+"&regionid="+e.regionid+"&objectid="+e.objectid+"&cacheid="+Math.random(),title:tagCloudConfiguratorTitle});return!0},initSiteMapConfigurator:function(e){this.initConfigurator(e,{url:"./",pars:"muraAction=cArch.loadclassconfigurator&compactDisplay=true&siteid="+siteid+"&classid=site_map&contentid="+contentid+"&parentid="+parentid+"&contenthistid="+contenthistid+"&regionid="+e.regionid+"&objectid="+e.objectid+"&cacheid="+Math.random(),title:siteMapConfiguratorTitle});return!0},initCategorySummaryConfigurator:function(e){if(typeof e.object!="undefined"&&e.object!="category_summary")return!1;this.initConfigurator(e,{url:"./",pars:"muraAction=cArch.loadclassconfigurator&compactDisplay=true&siteid="+siteid+"&classid=category_summary&contentid="+contentid+"&parentid="+parentid+"&contenthistid="+contenthistid+"&regionid="+e.regionid+"&objectid="+e.objectid+"&cacheid="+Math.random(),title:categorySummaryConfiguratorTitle});return!0},initFeedConfigurator:function(e){this.initConfigurator(e,{url:"./",pars:"muraAction=cArch.loadclassconfigurator&compactDisplay=true&siteid="+siteid+"&classid=feed&contentid="+contentid+"&parentid="+parentid+"&contenthistid="+contenthistid+"&regionid="+e.regionid+"&feedid="+e.objectid+"&cacheid="+Math.random(),title:"Loading...",init:function(e,t){e.type.toLowerCase()=="remote"?siteManager.configuratorMode=="frontEnd"?$("#configuratorHeader").html(remoteFeedConfiguratorTitle):$("#configuratorContainer").dialog("option","title",remoteFeedConfiguratorTitle):siteManager.configuratorMode=="frontEnd"?$("#configuratorHeader").html(localIndexConfiguratorTitle):$("#configuratorContainer").dialog("option","title",localIndexConfiguratorTitle);$("#availableListSort").length&&$("#availableListSort, #displayListSort").sortable({connectWith:".displayListSortOptions",update:function(e){e.stopPropagation();$("#displayList").val("");$("#displayListSort > li").each(function(){var e=$("#displayList").val();e!=""?$("#displayList").val(e+","+$.trim($(this).html())):$("#displayList").val($.trim($(this).html()))});siteManager.updateAvailableObject()}}).disableSelection()}});return!0},initSlideShowConfigurator:function(e){this.initConfigurator(e,{url:"./",pars:"muraAction=cArch.loadclassconfigurator&compactDisplay=true&siteid="+siteid+"&classid=feed_slideshow&contentid="+contentid+"&parentid="+parentid+"&contenthistid="+contenthistid+"&regionid="+e.regionid+"&feedid="+e.objectid+"&cacheid="+Math.random(),title:slideShowConfiguratorTitle,init:function(e,t){$("#availableListSort, #displayListSort").sortable({connectWith:".displayListSortOptions",update:function(e){e.stopPropagation();$("#displayList").val("");$("#displayListSort > li").each(function(){var e=$("#displayList").val();e!=""?$("#displayList").val(e+","+$(this).html()):$("#displayList").val($(this).html())});siteManager.vupdateAvailableObject()}}).disableSelection()}});return!0},initRelatedContentConfigurator:function(e){this.initConfigurator(e,{url:"./",pars:"muraAction=cArch.loadclassconfigurator&compactDisplay=true&siteid="+siteid+"&classid="+e.object+"&contentid="+contentid+"&parentid="+parentid+"&contenthistid="+contenthistid+"&regionid="+e.regionid+"&objectid="+e.objectid+"&cacheid="+Math.random(),title:relatedContentConfiguratorTitle,init:function(e,t){$("#availableListSort, #displayListSort").sortable({connectWith:".displayListSortOptions",update:function(e){e.stopPropagation();$("#displayList").val("");$("#displayListSort > li").each(function(){var e=$("#displayList").val();e!=""?$("#displayList").val(e+","+$(this).html()):$("#displayList").val($(this).html())});siteManager.updateAvailableObject()}}).disableSelection()}});return!0},initGenericConfigurator:function(e){this.resetAvailableObject();this.resetConfiguratorContainer();$("#configuratorContainer").dialog({resizable:!0,modal:!0,title:genericConfiguratorTitle,position:getDialogPosition(),buttons:{Cancel:function(){$(this).dialog("close")}},open:function(){$("#configurator").html('<div class="ui-dialog-content ui-widget-content">'+genericConfiguratorMessage+"</div>")},close:function(){$(this).dialog("destroy")}});return!0},updateAvailableObject:function(){var e={};$("#availableObjectParams").find(".objectParam").each(function(){var t=$(this);if(t.attr("type")!="radio"&&t.attr("type")!="checkbox"||(t.attr("type")=="radio"||t.attr("type")=="checkbox")&&t.is(":checked"))if(typeof e[t.attr("name")]=="undefined")e[t.attr("name")]=t.val();else{if(!$.isArray(e[t.attr("name")])){var n=[];n[0]=e[t.attr("name")];e[t.attr("name")]=n}e[t.attr("name")].push(t.val())}});this.availableObject=$.extend({},this.availableObjectTemplate);this.availableObject.params=e},initDisplayObjectConfigurators:function(){$(".displayRegions").dblclick(function(){var e=$(this).attr("data-regionid"),t=siteManager.getDisplayObjectConfig(e);if(t.object=="feed")siteManager.initFeedConfigurator(t);else if(t.object=="feed_slideshow")siteManager.initSlideShowConfigurator(t);else if(t.object=="tag_cloud"&&customtaggroups.length)siteManager.initTagCloudConfigurator(t);else if(allowopenfeeds&&t.object=="category_summary")siteManager.initCategorySummaryConfigurator(t);else if(t.object=="site_map")siteManager.initSiteMapConfigurator(t);else if(t.object=="related_content"||t.object=="related_section_content")siteManager.initRelatedContentConfigurator(t);else if(t.object=="plugin"){var n=siteManager.getPluginConfigurator(t.objectid);n!=""&&window[n](t)}else siteManager.initGenericConfigurator(t)})},resetAvailableObject:function(){this.availableObjectTemplate="";this.availableObject={};this.availableObjectValidate=function(){return!0}},resetConfiguratorContainer:function(){$("#configuratorContainer").remove();$("body").append('<div id="configuratorContainer" title="Loading..." style="display:none"><div id="configurator"><div class="load-inline"></div></div></div>');$("#configuratorContainer .load-inline").spin(spinnerArgs2)},initConfiguratorParams:function(){this.updateAvailableObject();$("#availableObjectParams").find(".objectParam").bind("change",function(){siteManager.updateAvailableObject()})},setContentDisplayListSort:function(){$("#contentAvailableListSort, #contentDisplayListSort").sortable({connectWith:".contentDisplayListSortOptions",update:function(e){e.stopPropagation();$("#contentDisplayList").val("");$("#contentDisplayListSort > li").each(function(){var e=$("#contentDisplayList").val();e!=""?$("#contentDisplayList").val(e+","+$.trim($(this).html())):$("#contentDisplayList").val($.trim($(this).html()))})}}).disableSelection()},configuratorMode:"backEnd",initConfigurator:function(data,config){this.resetAvailableObject();typeof config.validate!="undefined"&&(this.availableObjectValidate=config.validate);data.configuratorMode=this.configuratorMode;if(typeof data.object=="undefined")return!1;if(this.configuratorMode=="backEnd"){this.resetConfiguratorContainer();$("#configuratorContainer").dialog({resizable:!0,modal:!0,width:600,position:getDialogPosition(),buttons:{Save:function(){siteManager.updateAvailableObject();if(siteManager.availableObjectValidate(data.params)){siteManager.addDisplayObject(siteManager.availableObject,data.regionid,!1);typeof config.destroy!="undefined"&&config.destroy(data,config);$(this).dialog("destroy")}},Cancel:function(){typeof config.destroy!="undefined"&&config.destroy(data,config);$(this).dialog("destroy")}},close:function(){typeof config.destroy!="undefined"&&config.destroy(data,config);$(this).dialog("destroy")}})}$.ajax({url:config.url+"?"+config.pars,dataType:"text",data:data,type:"post",success:function(_resp){try{resp=eval("("+_resp+")")}catch(err){_resp.indexOf("mura-primary-login-token")!=-1&&(location.href="./");resp=_resp}typeof resp=="object"?$("#configurator").html(resp.html):typeof resp=="xml"?$("#configurator").html(resp.toString()):$("#configurator").html(resp);siteManager.configuratorMode=="frontEnd"?$("#configuratorHeader").html(config.title):$("#configuratorContainer").dialog("option","title",config.title);if(siteManager.availableObjectTemplate==""){var availableObjectContainer=$("#availableObjectParams");siteManager.availableObjectTemplate={object:availableObjectContainer.attr("data-object"),objectid:availableObjectContainer.attr("data-objectid"),name:availableObjectContainer.attr("data-name")};siteManager.availableObject=$.extend({},siteManager.availableObjectTemplate)}if(typeof config.init!="undefined"){typeof resp=="object"&&(data=$.extend(data,resp));config.init(data,config)}if(siteManager.configuratorMode=="backEnd")$("#configuratorContainer").dialog("option","position",getDialogPosition());else if(siteManager.configuratorMode=="frontEnd"){$("#actionButtons").show();$("#configuratorNotices").show()}}});return!0},getPluginConfigurator:function(e){for(var t=0;t<pluginConfigurators.length;t++)if(pluginConfigurators[t].objectid==e)return pluginConfigurators[t].init;return""},openContentDiff:function(e,t,n){$("#contentDiffContainer").remove();$("body").append('<div id="contentDiffContainer" title="Loading..." style="display:none"><div class="ui-dialog-content ui-widget-content"><div class="load-inline"></div></div></div>');$("#contentDiffContainer .load-inline").spin(spinnerArgs2);$("#contentDiffContainer").dialog({resizable:!1,modal:!0,width:750,title:"Code & Attribute Diff",position:getDialogPosition(),open:function(){$("#contentDiffContainer").html('<div class="ui-dialog-content ui-widget-content"><div class="load-inline"></div></div>');var r="./index.cfm",i="muraAction=cArch.loaddiff&compactDisplay=true&siteid="+n+"&contenthistid1="+e+"&contenthistid2="+t+"&cacheid="+Math.random();$.ajax(r+"?"+i).done(function(e){e.indexOf("mura-primary-login-token")!=-1&&(location.href="./");$("#contentDiffContainer .load-inline").spin(!1);$("#contentDiffContainer").html(e);$("#contentDiffContainer").dialog("option","position","center");$(".ui-widget-overlay").css("height",$(document).height())}).fail(function(e){e.responseText.indexOf("mura-primary-login-token")!=-1&&(location.href="./");$("#contentDiffContainer .load-inline").spin(!1);$("#contentDiffContainer").html(e.responseText);$("#contentDiffContainer").dialog("option","position","center")})},close:function(){$(this).dialog("destroy");$("#contentDiffContainer").remove()}});return!1}};quickEditTmpl='<div class="mura-quickEdit" id="mura-quickEditor">';quickEditTmpl+='<img class="loader" src="assets/images/ajax-loader-alt.gif" />';quickEditTmpl+="</div>";$(document).ready(function(){siteManager.initDisplayObjectConfigurators()});